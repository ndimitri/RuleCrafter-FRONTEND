<header>
  <h1>Character Creation</h1>
</header>

<section>
  <form [formGroup]="fullForm" (ngSubmit)="submit()">

    <div formGroupName="characterForm">
      <div class="characterForm">
        <div class="characterForm-name">
          <label for="name">Name : </label>
          <input id="name" type="text" placeholder="Name" formControlName="name">
        </div>

        <div class="characterForm-hp">
          <label for="hp">HP : </label>
          <input id="hp" type="number" placeholder="Hp" formControlName="hp">
        </div>

        <div class="characterForm-races">
          <label for="race">Race : </label>
          <select id="race" formControlName="race">
            <option *ngFor="let race of this.races?.results" [value]="race.index">
              {{race.name}}
            </option>
          </select>
        </div>

        <div class="characterForm-alignment">
          <label for="alignment">Alignment : </label>
          <select id="alignment" formControlName="alignment">
            <option *ngFor="let alignment of Alignment | keyvalue" [value]="alignment.key">
              {{alignment.value | titlecase}}
            </option>
          </select>
        </div>

        <div class="characterForm-backstory">
          <label for="backstory">Backstory : </label>
          <textarea id="backstory" rows="5" cols="15" formControlName="backstory"></textarea>
        </div>

        <div class="characterForm-background">
          <label for="background">Background : </label>
          <input id="background" type="text" placeholder="Sage" formControlName="background">
        </div>


        <div formArrayName="classes">
          <h3>Classes : </h3>
          @for(classe of classes.controls; track i; let i = $index){
            <div>
              <label for="class-{{i}}">Classe {{i+1}} : </label>
              <select id="class-{{i}}" [formControlName]="i">
                @for(apiClasse of classesB; track apiClasse.index){
                  <option [value]="apiClasse.index">
                    {{apiClasse.name}}
                  </option>
                }
              </select>
            </div>
          }

        </div>
<!--        <div>-->
<!--          @if (classes.length < 2){-->
<!--            <button type="button" (click)="addClass()">-->
<!--              Add class-->
<!--            </button>-->
<!--          }-->
<!--        </div>-->

        <div formArrayName="feats">
          <div *ngFor="let feat of feats.controls; let i = index" [formGroupName]="i">
            <!-- Champs de la Feat -->
            <label>
              Feat Name:
              <input formControlName="name" placeholder="Name" />
            </label>
            <label>
              Notes:
              <textarea formControlName="notes" placeholder="Description"></textarea>
            </label>


            <!-- Rollable Properties -->
            <h4>Rollable Properties</h4>
            <div formArrayName="rollableProps">
              <div *ngFor="let prop of getRollableProps(i).controls; let j = index" [formGroupName]="j">
                <label>
                  Name:
                  <input formControlName="name" placeholder="Property Name" />
                </label>
                <label>
                  Magnitude:
                  <input formControlName="magnitude" placeholder="Magnitude" />
                </label>
                <label>
                  Type:
                  <input formControlName="magnitudeType" placeholder="Type" />
                </label>
                <button type="button" (click)="removeRollableProp(i, j)">Remove Rollable Property</button>
              </div>

            </div>
            <button type="button" (click)="addRollableProp(i)">Add Rollable Property</button>
            <button type="button" (click)="removeFeat(i)">Remove Feat</button>

          </div>

        </div>
        <button type="button" (click)="addFeat()">Add Feat</button>


<!--        <div>-->
<!--          <div formArrayName="feats">-->
<!--            <div class="feat-card">-->
<!--              &lt;!&ndash; Card Header &ndash;&gt;-->
<!--              <div class="feat-card-header">-->
<!--                <strong>Feat </strong>-->
<!--&lt;!&ndash;                <button type="button" class="remove-btn">Remove</button>&ndash;&gt;-->
<!--              </div>-->

<!--              &lt;!&ndash; Card Body &ndash;&gt;-->
<!--              <div class="feat-card-body">-->
<!--                &lt;!&ndash; Feat Name &ndash;&gt;-->
<!--                <div class="form-group">-->
<!--                  <label for="name">Name</label>-->
<!--                  <input formControlName="name" class="input-field" placeholder="Enter feat name" />-->
<!--                </div>-->

<!--                &lt;!&ndash; Feat Notes &ndash;&gt;-->
<!--                <div class="form-group">-->
<!--                  <label for="notes">Notes</label>-->
<!--                  <textarea id="notes" formControlName="notes" class="input-field" placeholder="Enter feat description"></textarea>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->

<!--          &lt;!&ndash; Add Feat Button &ndash;&gt;-->
<!--          <button type="button" class="add-btn" (click)="addFeat()">Add Feat</button>-->
<!--        </div>-->




      </div>

    </div>

    <div [formGroup]="statsForm">
      <div class="statsForm">
          @for(stat of stats?.results; track stat.index){
            <div class="statsForm-stat-name">
              <label [for]="stat.index">{{stat.name}}</label>
            </div>
            <div class="statsForm-stat-value">
              <input [id]="stat.index" type="number" placeholder="0" [formControlName]="stat.index">
            </div>
          }

      </div>

    </div>



  </form>
</section>
